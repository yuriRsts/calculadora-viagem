<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Viagem</title>

<style>
* {
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  margin: 0;
  min-height: 100vh;
  background: #1e1e1e;
  display: flex;
  justify-content: center;
  padding: 20px;
  color: #fff;
}

.container {
  width: 100%;
  max-width: 420px;
  background: #2a2a2a;
  padding: 20px;
  border-radius: 12px;
}

h2 {
  text-align: center;
  margin-bottom: 20px;
}

input, button {
  width: 100%;
  height: 46px;
  margin-bottom: 10px;
  border-radius: 8px;
  border: 1px solid #444;
  background: #1f1f1f;
  color: #fff;
  padding: 0 12px;
  font-size: 15px;
}

button {
  background: linear-gradient(135deg, #4a90e2, #357ab8);
  border: none;
  font-weight: bold;
  cursor: pointer;
}

.info {
  font-size: 13px;
  color: #bbb;
  margin-bottom: 8px;
}

.resultado {
  margin-top: 12px;
  background: #1b1b1b;
  padding: 12px;
  border-radius: 8px;
  font-size: 14px;
}

.mapa {
  width: 100%;
  height: 260px;
  margin-top: 12px;
  border-radius: 10px;
  overflow: hidden;
}
</style>
</head>

<body>

<div class="container">
  <h2>Calculadora de Viagem</h2>

  <input id="origem" placeholder="Endere√ßo de origem">
  <input id="destino" placeholder="Endere√ßo de destino">
  <input id="kmLitro" type="number" step="0.1" placeholder="Km por litro">
  <input id="precoGasolina" type="number" step="0.01" placeholder="Pre√ßo da gasolina">

  <div class="info">
    üõ£Ô∏è Ped√°gio estimado automaticamente pela dist√¢ncia.<br>
    (Opcional) Informe abaixo para substituir o valor.
  </div>

  <input id="pedagioManual" type="number" step="0.01" placeholder="Ped√°gio manual (opcional)">

  <button onclick="calcular()">Calcular</button>

  <div id="resultado" class="resultado" style="display:none"></div>
  <div id="mapa" class="mapa"></div>
</div>

<script>
let map, directionsService, directionsRenderer, autocompleteService;

const VALOR_PEDAGIO_POR_KM = 0.08; // AJUSTE AQUI

function initMap() {
  map = new google.maps.Map(document.getElementById("mapa"), {
    center: { lat: -23.55, lng: -46.63 },
    zoom: 5
  });

  directionsService = new google.maps.DirectionsService();
  directionsRenderer = new google.maps.DirectionsRenderer({ map });

  autocompleteService = new google.maps.places.AutocompleteService();
  configurarAutocomplete("origem");
  configurarAutocomplete("destino");
}

function configurarAutocomplete(id) {
  const input = document.getElementById(id);
  const lista = document.createElement("div");

  lista.style.position = "absolute";
  lista.style.background = "#1b1b1b";
  lista.style.border = "1px solid #444";
  lista.style.borderRadius = "6px";
  lista.style.zIndex = "9999";
  lista.style.display = "none";

  document.body.appendChild(lista);

  input.addEventListener("input", () => {
    const valor = input.value.trim();
    if (valor.length < 3) return;

    const rect = input.getBoundingClientRect();
    lista.style.left = rect.left + "px";
    lista.style.top = rect.bottom + window.scrollY + "px";
    lista.style.width = rect.width + "px";

    autocompleteService.getPlacePredictions(
      { input: valor, componentRestrictions: { country: "br" } },
      predictions => {
        lista.innerHTML = "";
        if (!predictions) return;

        predictions.forEach(p => {
          const item = document.createElement("div");
          item.textContent = p.description;
          item.style.padding = "10px";
          item.style.cursor = "pointer";
          item.onclick = () => {
            input.value = p.description;
            lista.style.display = "none";
          };
          lista.appendChild(item);
        });

        lista.style.display = "block";
      }
    );
  });

  document.addEventListener("click", e => {
    if (e.target !== input) lista.style.display = "none";
  });
}

function calcular() {
  const origem = document.getElementById("origem").value;
  const destino = document.getElementById("destino").value;
  const kmLitro = parseFloat(document.getElementById("kmLitro").value);
  const preco = parseFloat(document.getElementById("precoGasolina").value);
  const pedagioManual = parseFloat(document.getElementById("pedagioManual").value);

  if (!origem || !destino) {
    alert("Informe origem e destino");
    return;
  }

  if (isNaN(kmLitro) || kmLitro <= 0 || isNaN(preco) || preco <= 0) {
    alert("Preencha corretamente os dados do ve√≠culo");
    return;
  }

  directionsService.route(
    { origin: origem, destination: destino, travelMode: "DRIVING" },
    (res, status) => {
      if (status !== "OK") {
        alert("Erro ao calcular rota");
        return;
      }

      directionsRenderer.setDirections(res);

      const rota = res.routes[0].legs[0];
      const distanciaKm = rota.distance.value / 1000;
      const duracao = rota.duration.text;

      const combustivel = (distanciaKm / kmLitro) * preco;
      const pedagioEstimado = distanciaKm * VALOR_PEDAGIO_POR_KM;
      const pedagioFinal =
        !isNaN(pedagioManual) && pedagioManual > 0
          ? pedagioManual
          : pedagioEstimado;

      const total = combustivel + pedagioFinal;

      document.getElementById("resultado").style.display = "block";
      document.getElementById("resultado").innerHTML = `
        üìè Dist√¢ncia: ${distanciaKm.toFixed(2)} km<br>
        ‚è±Ô∏è Tempo: ${duracao}<br>
        ‚õΩ Combust√≠vel: R$ ${combustivel.toFixed(2)}<br>
        üõ£Ô∏è Ped√°gio estimado: R$ ${pedagioEstimado.toFixed(2)}<br>
        üí∞ Total: R$ ${total.toFixed(2)}
      `;
    }
  );
}
</script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiYWC1UozNM6xqegQg__CQvNA3FXgFbEA&libraries=places&callback=initMap">
</script>

</body>
</html>
