<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Calculadora de Viagem</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; font-family: Arial, sans-serif; }

body {
  margin: 0;
  min-height: 100vh;
  background: #1e1e1e;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding-top: 60px;
}

.container {
  width: 100%;
  max-width: 420px;
  background: #2a2a2a;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  color: #fff;
}

h2 {
  text-align: center;
  margin-bottom: 20px;
}

input, button {
  width: 100%;
  height: 46px;
  margin-bottom: 12px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #444;
  background: #1f1f1f;
  color: #fff;
  font-size: 15px;
}

input:focus {
  outline: none;
  border-color: #4a90e2;
}

button {
  background: linear-gradient(135deg, #4a90e2, #357abd);
  border: none;
  cursor: pointer;
  font-weight: bold;
}

button:hover { opacity: 0.9; }

#resultado {
  margin-top: 12px;
  background: #1f1f1f;
  padding: 12px;
  border-radius: 8px;
  font-size: 14px;
}

#map {
  width: 100%;
  height: 220px;
  margin-top: 12px;
  border-radius: 10px;
  overflow: hidden;
  display: none;
}

/* Lista de sugest√µes */
.sugestoes {
  position: absolute;
  background: #1f1f1f;
  border: 1px solid #444;
  border-radius: 8px;
  z-index: 9999;
  display: none;
}

.sugestoes div {
  padding: 10px;
  cursor: pointer;
  color: #fff;
}

.sugestoes div:hover {
  background: #333;
}
</style>
</head>

<body>

<div class="container">
  <h2>Calculadora de Viagem</h2>

  <input id="origem" placeholder="Endere√ßo de origem">
  <input id="destino" placeholder="Endere√ßo de destino">
  <input id="kmLitro" type="number" placeholder="Km por litro">
  <input id="precoGasolina" type="number" step="0.01" placeholder="Pre√ßo da gasolina">

  <button onclick="calcular()">Calcular</button>

  <div id="resultado"></div>
  <div id="map"></div>
</div>

<script>
let autocompleteService;
let map, directionsService, directionsRenderer;

function initAutocomplete() {
  autocompleteService = new google.maps.places.AutocompleteService();
  configurarCampo("origem");
  configurarCampo("destino");

  directionsService = new google.maps.DirectionsService();
  directionsRenderer = new google.maps.DirectionsRenderer({ suppressMarkers: false });
}

function configurarCampo(id) {
  const input = document.getElementById(id);
  const lista = document.createElement("div");
  lista.className = "sugestoes";
  document.body.appendChild(lista);

  input.addEventListener("input", () => {
    const valor = input.value.trim();
    if (valor.length < 3) {
      lista.style.display = "none";
      return;
    }

    autocompleteService.getPlacePredictions(
      {
        input: valor,
        componentRestrictions: { country: "br" }
      },
      (predictions, status) => {
        lista.innerHTML = "";
        if (!predictions || status !== "OK") {
          lista.style.display = "none";
          return;
        }

        predictions.forEach(p => {
          const item = document.createElement("div");
          item.textContent = p.description;
          item.onclick = () => {
            input.value = p.description;
            lista.style.display = "none";
          };
          lista.appendChild(item);
        });

        const rect = input.getBoundingClientRect();
        lista.style.width = rect.width + "px";
        lista.style.left = rect.left + "px";
        lista.style.top = rect.bottom + window.scrollY + "px";
        lista.style.display = "block";
      }
    );
  });

  document.addEventListener("click", e => {
    if (e.target !== input) lista.style.display = "none";
  });
}

function calcular() {
  const origem = origemInput.value;
  const destino = destinoInput.value;
  const kmLitro = parseFloat(kmLitroInput.value);
  const preco = parseFloat(precoGasolinaInput.value);

  if (!origem || !destino || !kmLitro || !preco) {
    resultado.innerHTML = "‚ö†Ô∏è Preencha todos os campos.";
    return;
  }

  directionsService.route(
    {
      origin: origem,
      destination: destino,
      travelMode: google.maps.TravelMode.DRIVING
    },
    (response, status) => {
      if (status !== "OK") {
        resultado.innerHTML = "‚ùå N√£o foi poss√≠vel calcular a rota.";
        return;
      }

      const rota = response.routes[0].legs[0];
      const distanciaKm = rota.distance.value / 1000;
      const tempo = rota.duration.text;
      const consumo = distanciaKm / kmLitro;
      const custo = consumo * preco;

      resultado.innerHTML = `
        üìç <b>Dist√¢ncia:</b> ${distanciaKm.toFixed(2)} km<br>
        ‚è± <b>Tempo estimado:</b> ${tempo}<br>
        ‚õΩ <b>Consumo:</b> ${consumo.toFixed(2)} L<br>
        üí∞ <b>Custo estimado:</b> R$ ${custo.toFixed(2)}
      `;

      if (!map) {
        map = new google.maps.Map(document.getElementById("map"), {
          zoom: 7,
          center: rota.start_location
        });
        directionsRenderer.setMap(map);
      }

      document.getElementById("map").style.display = "block";
      directionsRenderer.setDirections(response);
    }
  );
}

// atalhos
const origemInput = document.getElementById("origem");
const destinoInput = document.getElementById("destino");
const kmLitroInput = document.getElementById("kmLitro");
const precoGasolinaInput = document.getElementById("precoGasolina");
const resultado = document.getElementById("resultado");
</script>

<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiYWC1UozNM6xqegQg__CQvNA3FXgFbEA&libraries=places&callback=initAutocomplete"
  async defer>
</script>

</body>
</html>
