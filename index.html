<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Viagem</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1f1f1f">

<style>
*{box-sizing:border-box;font-family:Arial,sans-serif}
body{
  margin:0;
  min-height:100vh;
  background:#1e1e1e;
  display:flex;
  justify-content:center;
  padding:16px;
  color:#fff;
}
.container{
  width:100%;
  max-width:420px;
  background:#2a2a2a;
  padding:20px;
  border-radius:14px;
}
h1{text-align:center;margin-bottom:16px}
input,button{
  width:100%;
  height:44px;
  margin-bottom:10px;
  border-radius:8px;
  border:1px solid #444;
  background:#1f1f1f;
  color:#fff;
  padding:0 12px;
}
button{
  background:#4a90e2;
  border:none;
  font-weight:bold;
  cursor:pointer;
}
.result{
  background:#1f1f1f;
  border-radius:8px;
  padding:10px;
  margin-top:10px;
  font-size:14px;
}
.map{
  width:100%;
  height:220px;
  margin-top:10px;
  border-radius:10px;
  overflow:hidden;
}
.actions button{
  margin-top:8px;
}
.history{
  margin-top:12px;
  font-size:13px;
}
.history div{
  background:#1f1f1f;
  padding:6px;
  border-radius:6px;
  margin-top:6px;
}
</style>
</head>

<body>
<div class="container">
<h1>Calculadora de Viagem</h1>

<input id="origem" placeholder="Endere√ßo de origem">
<input id="destino" placeholder="Endere√ßo de destino">
<input id="kmLitro" type="number" placeholder="Km por litro">
<input id="precoGasolina" type="number" placeholder="Pre√ßo da gasolina">
<input id="pedagioManual" type="number" placeholder="Ped√°gio manual (opcional)">

<button onclick="calcular()">Calcular</button>

<div id="resultado" class="result" style="display:none"></div>

<div class="actions">
<button onclick="abrirGoogle()">Abrir no Google Maps</button>
<button onclick="abrirWaze()">Abrir no Waze</button>
</div>

<div id="map" class="map"></div>

<div class="history">
<strong>Hist√≥rico</strong>
<div id="historico"></div>
</div>
</div>

<script>
const API_KEY = "SUA_API_KEY_AQUI";

let map, directionsService, directionsRenderer;

function initMap(){
  map = new google.maps.Map(document.getElementById("map"), {
    zoom:5,
    center:{lat:-15,lng:-55}
  });
  directionsService = new google.maps.DirectionsService();
  directionsRenderer = new google.maps.DirectionsRenderer({map});
}

function calcular(){
  const origem = origemInput.value;
  const destino = destinoInput.value;
  const kmLitro = parseFloat(kmLitroInput.value);
  const preco = parseFloat(precoGasolinaInput.value);
  const pedagioManual = parseFloat(pedagioManualInput.value)||0;

  if(!origem || !destino || !kmLitro || !preco){
    alert("Preencha todos os campos obrigat√≥rios");
    return;
  }

  directionsService.route({
    origin:origem,
    destination:destino,
    travelMode:"DRIVING"
  },(res,status)=>{
    if(status!=="OK") return alert("Erro ao calcular rota");

    directionsRenderer.setDirections(res);

    const leg = res.routes[0].legs[0];
    const distanciaKm = leg.distance.value/1000;
    const tempo = leg.duration.text;

    const litros = distanciaKm/kmLitro;
    const custoComb = litros*preco;

    const pedagioAuto = distanciaKm * 0.15;
    const total = custoComb + pedagioAuto + pedagioManual;

    resultado.innerHTML = `
    üìç Dist√¢ncia: ${distanciaKm.toFixed(2)} km<br>
    ‚è± Tempo estimado: ${tempo}<br>
    ‚õΩ Combust√≠vel: R$ ${custoComb.toFixed(2)}<br>
    üõ£ Ped√°gio estimado: R$ ${pedagioAuto.toFixed(2)}<br>
    ‚ûï Ped√°gio manual: R$ ${pedagioManual.toFixed(2)}<br>
    üí∞ <strong>Total: R$ ${total.toFixed(2)}</strong>
    `;
    resultado.style.display="block";

    salvarRota({origem,destino,total});
    carregarHistorico();
  });
}

function salvarRota(d){
  let h = JSON.parse(localStorage.getItem("historico"))||[];
  h.unshift(d);
  h = h.slice(0,5);
  localStorage.setItem("historico",JSON.stringify(h));
  localStorage.setItem("ultima",JSON.stringify(d));
}

function carregarHistorico(){
  const h = JSON.parse(localStorage.getItem("historico"))||[];
  historico.innerHTML="";
  h.forEach(i=>{
    historico.innerHTML+=`<div>${i.origem} ‚Üí ${i.destino}<br>Total: R$ ${i.total.toFixed(2)}</div>`;
  });
}

function abrirGoogle(){
  window.open(`https://www.google.com/maps/dir/${origemInput.value}/${destinoInput.value}`);
}
function abrirWaze(){
  window.open(`https://waze.com/ul?q=${destinoInput.value}`);
}

const origemInput = document.getElementById("origem");
const destinoInput = document.getElementById("destino");
const kmLitroInput = document.getElementById("kmLitro");
const precoGasolinaInput = document.getElementById("precoGasolina");
const pedagioManualInput = document.getElementById("pedagioManual");

carregarHistorico();
</script>

<script async
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiYWC1UozNM6xqegQg__CQvNA3FXgFbEA&libraries=places&callback=initMap">
</script>

</body>
</html>
